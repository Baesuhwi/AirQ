<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yjc.airq.mapper.MypageMapper">
	<!-- 마이페이지 판매자 그래프 -->
	<select id="c_code" resultType="com.yjc.airq.domain.Company_InfoVO">
		select c.company_code,m.member_id, to_char(d.demand_date,'yy-mm') as month, sum(P.payment_price) as sum
			from DEMAND D, PAYMENT P, MEMBER M, company_info C,PRODUCT PR 
			where D.DEMAND_CODE = P.DEMAND_CODE
			and M.MEMBER_ID = C.MEMBER_ID 
			and PR.PRODUCT_CODE = D.PRODUCT_CODE 
			and PR.COMPANY_CODE = C.COMPANY_CODE  
			and c.company_code= (select company_code from company_info where member_id = #{member_id})
			group by c.company_code,m.member_id, to_char(d.demand_date,'yy-mm')
			order by to_char(d.demand_date,'yy-mm')
	</select>

</mapper>
